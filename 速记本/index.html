<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuickNotes - æç®€è®°äº‹æœ¬</title>
    <style>
        :root {
            /* æ—¥é—´æ¨¡å¼å˜é‡ */
            --bg-color: #f0f2f5;
            --card-bg: #ffffff;
            --text-main: #2c3e50;
            --text-sub: #7f8c8d;
            --accent: #3498db;
            --border: #e0e0e0;
            --shadow: 0 10px 25px rgba(0,0,0,0.05);
            --btn-hover: #f7f9fc;
            --scrollbar-thumb: #cbd5e0;
        }

        [data-theme="dark"] {
            /* å¤œé—´æ¨¡å¼å˜é‡ */
            --bg-color: #1a1a1a;
            --card-bg: #2d2d2d;
            --text-main: #e0e0e0;
            --text-sub: #a0a0a0;
            --accent: #5dade2;
            --border: #404040;
            --shadow: 0 10px 25px rgba(0,0,0,0.3);
            --btn-hover: #3d3d3d;
            --scrollbar-thumb: #555;
        }

        * { box-sizing: border-box; transition: background-color 0.3s, color 0.3s; }
        
        body {
            margin: 0;
            padding: 0;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* ä¸»å®¹å™¨ */
        .container {
            width: 90%;
            max-width: 800px;
            height: 90vh;
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        /* é¡¶éƒ¨ Header */
        header {
            padding: 15px 25px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--card-bg); /* é˜²æ­¢æ»šåŠ¨ç©¿é€ */
        }

        .brand {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--accent);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .toolbar {
            display: flex;
            gap: 10px;
        }

        button {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-main);
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        button:hover {
            background-color: var(--btn-hover);
            border-color: var(--accent);
            color: var(--accent);
        }

        /* è®°äº‹åŒºåŸŸ */
        .editor-wrapper {
            flex: 1;
            position: relative;
            display: flex;
        }

        textarea {
            width: 100%;
            height: 100%;
            border: none;
            resize: none;
            padding: 25px;
            font-size: 1.1rem;
            line-height: 1.6;
            background: transparent;
            color: var(--text-main);
            outline: none;
            font-family: inherit; /* é»˜è®¤ç»§æ‰¿ï¼Œå¯JSåˆ‡æ¢ */
        }

        textarea::placeholder {
            color: var(--text-sub);
            opacity: 0.5;
        }

        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
        textarea::-webkit-scrollbar { width: 8px; }
        textarea::-webkit-scrollbar-track { background: transparent; }
        textarea::-webkit-scrollbar-thumb { background-color: var(--scrollbar-thumb); border-radius: 4px; }

        /* åº•éƒ¨çŠ¶æ€æ  */
        footer {
            padding: 10px 25px;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85rem;
            color: var(--text-sub);
            background: var(--card-bg);
        }

        .stats {
            display: flex;
            gap: 20px;
        }

        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #ccc;
        }
        .status-dot.saved { background-color: #2ecc71; }
        .status-dot.saving { background-color: #f1c40f; }

        .time-display {
            font-variant-numeric: tabular-nums; /* ç­‰å®½æ•°å­—ï¼Œé˜²æ­¢æ—¶é—´è·³åŠ¨ */
        }

        /* åˆ‡æ¢å¼€å…³æ ·å¼ */
        .theme-toggle {
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            user-select: none;
        }

        /* å­—ä½“ç±» */
        .font-mono { font-family: 'Consolas', 'Monaco', 'Courier New', monospace; }
        .font-hand { font-family: 'Comic Sans MS', 'Chalkboard SE', sans-serif; }

        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 600px) {
            .container { width: 100%; height: 100vh; border-radius: 0; }
            .btn-text { display: none; } /* çª„å±éšè—æŒ‰é’®æ–‡å­— */
            header { padding: 10px 15px; }
            textarea { padding: 15px; font-size: 1rem; }
            footer { flex-direction: column; gap: 10px; align-items: flex-start; }
            .theme-toggle { position: absolute; right: 15px; bottom: 12px; }
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- å¤´éƒ¨ -->
        <header>
            <div class="brand">
                <span>ğŸ“</span> QuickNotes
            </div>
            <div class="toolbar">
                <button onclick="toggleFont()" title="åˆ‡æ¢å­—ä½“">
                    <span>Aa</span>
                </button>
                <button onclick="downloadNote()" title="å¯¼å‡ºä¸ºTXT">
                    <span>ğŸ“¥</span> <span class="btn-text">å¯¼å‡º</span>
                </button>
                <button onclick="clearNote()" title="æ¸…ç©ºå†…å®¹">
                    <span>ğŸ—‘ï¸</span> <span class="btn-text">æ¸…ç©º</span>
                </button>
            </div>
        </header>

        <!-- ç¼–è¾‘åŒº -->
        <div class="editor-wrapper">
            <textarea id="noteArea" placeholder="åœ¨æ­¤å¤„å¼€å§‹è¾“å…¥... (Ctrl+S ä¿å­˜)" spellcheck="false"></textarea>
        </div>

        <!-- åº•éƒ¨ -->
        <footer>
            <div class="stats">
                <span>å­—æ•°: <b id="wordCount">0</b></span>
                <span class="status-indicator">
                    <span class="status-dot saved" id="statusDot"></span>
                    <span id="saveStatus">å·²ä¿å­˜</span>
                </span>
            </div>
            
            <div style="display: flex; gap: 20px; align-items: center;">
                <span class="time-display" id="currentTime">--:--</span>
                <div class="theme-toggle" onclick="toggleTheme()">
                    <span id="themeIcon">ğŸŒ™</span>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // DOM å…ƒç´ è·å–
        const textarea = document.getElementById('noteArea');
        const wordCountEl = document.getElementById('wordCount');
        const saveStatusEl = document.getElementById('saveStatus');
        const statusDot = document.getElementById('statusDot');
        const timeEl = document.getElementById('currentTime');
        const themeIcon = document.getElementById('themeIcon');
        
        let saveTimeout;

        // 1. åˆå§‹åŒ–åŠ è½½
        window.addEventListener('DOMContentLoaded', () => {
            // åŠ è½½å†…å®¹
            const savedNote = localStorage.getItem('quickNotes_content');
            if (savedNote) {
                textarea.value = savedNote;
                updateWordCount();
            }

            // åŠ è½½ä¸»é¢˜
            const savedTheme = localStorage.getItem('quickNotes_theme');
            if (savedTheme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
                themeIcon.textContent = 'â˜€ï¸';
            }

            // å¯åŠ¨æ—¶é’Ÿ
            updateTime();
            setInterval(updateTime, 1000);
        });

        // 2. è‡ªåŠ¨ä¿å­˜ä¸è¾“å…¥ç›‘å¬
        textarea.addEventListener('input', () => {
            updateWordCount();
            setStatus('saving');
            
            // é˜²æŠ–ï¼šåœæ­¢è¾“å…¥ 500ms åæ‰§è¡Œä¿å­˜
            clearTimeout(saveTimeout);
            saveTimeout = setTimeout(() => {
                saveToLocal();
            }, 500);
        });

        // 3. å¿«æ·é”®æ”¯æŒ
        document.addEventListener('keydown', (e) => {
            // Ctrl + S
            if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                e.preventDefault();
                saveToLocal();
            }
            // Tab é”®æ”¯æŒ (è¾“å…¥4ä¸ªç©ºæ ¼)
            if (e.key === 'Tab' && document.activeElement === textarea) {
                e.preventDefault();
                const start = textarea.selectionStart;
                const end = textarea.selectionEnd;
                textarea.value = textarea.value.substring(0, start) + "    " + textarea.value.substring(end);
                textarea.selectionStart = textarea.selectionEnd = start + 4;
                setStatus('saving');
                saveToLocal();
            }
        });

        // æ ¸å¿ƒåŠŸèƒ½å‡½æ•°
        function saveToLocal() {
            localStorage.setItem('quickNotes_content', textarea.value);
            setStatus('saved');
        }

        function setStatus(status) {
            if (status === 'saving') {
                saveStatusEl.textContent = 'ä¿å­˜ä¸­...';
                statusDot.className = 'status-dot saving';
            } else {
                saveStatusEl.textContent = 'å·²ä¿å­˜';
                statusDot.className = 'status-dot saved';
            }
        }

        function updateWordCount() {
            const text = textarea.value;
            // ç®€å•çš„å­—æ•°ç»Ÿè®¡ï¼ˆå«æ ‡ç‚¹ï¼Œå»é™¤æ”¶å°¾ç©ºæ ¼ï¼‰
            wordCountEl.textContent = text.length; 
        }

        function clearNote() {
            if (textarea.value.trim() === '') return;
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å†…å®¹å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ã€‚')) {
                textarea.value = '';
                saveToLocal();
                updateWordCount();
                textarea.focus();
            }
        }

        function downloadNote() {
            const text = textarea.value;
            if (!text) {
                alert('æ²¡æœ‰å†…å®¹å¯å¯¼å‡ºï¼');
                return;
            }
            
            const blob = new Blob([text], { type: 'text/plain' });
            const anchor = document.createElement('a');
            
            // ç”Ÿæˆæ–‡ä»¶å: QuickNotes_2026-02-18.txt
            const dateStr = new Date().toISOString().split('T')[0];
            anchor.download = `QuickNotes_${dateStr}.txt`;
            
            anchor.href = window.URL.createObjectURL(blob);
            anchor.target = '_blank';
            anchor.style.display = 'none';
            document.body.appendChild(anchor);
            anchor.click();
            document.body.removeChild(anchor);
        }

        // è¾…åŠ©åŠŸèƒ½å‡½æ•°
        function updateTime() {
            const now = new Date();
            // æ ¼å¼åŒ–ä¸º 2026-02-18 12:00
            const dateStr = now.toISOString().split('T')[0];
            const timeStr = now.toTimeString().split(' ')[0].substring(0, 5);
            timeEl.textContent = `${dateStr} ${timeStr}`;
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            themeIcon.textContent = newTheme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
            localStorage.setItem('quickNotes_theme', newTheme);
        }

        function toggleFont() {
            if (textarea.classList.contains('font-mono')) {
                textarea.classList.remove('font-mono');
                textarea.classList.add('font-hand');
            } else if (textarea.classList.contains('font-hand')) {
                textarea.classList.remove('font-hand');
            } else {
                textarea.classList.add('font-mono');
            }
            // å¾ªç¯é¡ºåºï¼šé»˜è®¤ -> ç­‰å®½ -> æ‰‹å†™ -> é»˜è®¤
        }
    </script>
</body>
</html>